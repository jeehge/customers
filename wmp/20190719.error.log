java.lang.IllegalStateException: Cannot send a message when session is closed
        at org.springframework.util.Assert.state(Assert.java:70)
        at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:160)
        at com.happyhouse.servers.ps.service.PushService$PrivatePushService.push(PushService.java:264)
        at com.happyhouse.servers.ps.service.PushService.pushItem(PushService.java:66)
        at com.happyhouse.servers.ps.service.PrivatePushService.push(PrivatePushService.java:105)
        at com.happyhouse.servers.ps.service.PushItemServiceHandler.handler(PushItemServiceHandler.java:166)
        at com.happyhouse.servers.ps.service.MessageDirector.handleByPushType(MessageDirector.java:214)
        at com.happyhouse.servers.ps.service.MessageDirector.director(MessageDirector.java:186)
        at com.happyhouse.servers.ps.repository.queue.listener.RestfulPushItemListBackgroundQueueItemListener.handler(RestfulPushItemListBackgroundQueueItemListener.java:85)
        at com.happyhouse.servers.ps.repository.queue.listener.RestfulPushItemListBackgroundQueueItemListener.run(RestfulPushItemListBackgroundQueueItemListener.java:54)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.Thread.run(Thread.java:745)
---------------------------------------------------------------------------------------------------------------------------------------
[2019-07-04 16:19:51][ERROR][o.s.w.s.a.s.StandardWebSocketHandlerAdapter] - Closing session due to exception for StandardWebSocketSession[id=64, uri=ws://wink.wemakepeople.com:9093/websocket/277/2ha4bq5o/websocket]
org.springframework.web.socket.sockjs.SockJsMessageDeliveryException: Failed to deliver message(s) [{"body":{"pushItemResultList":[{"deviceMessageUuid":"TMT124e22c360b5423e86cfefedd5b488f7171080392139804410","type":"PPC","status":0}]},"header":{"status":0},"platform-header":{"VERSION":"PHV102","APPLICATION_ID":"PFAP","MESSAGE_ID":"M00000002","SESSION_ID":0,"TRANSACTION_ID":1553440026465,"SERVICE_ID":0,"IMEI":"00000000000000000000","WIFI_MAC":"309C23E240EE","MSISDN":"309C23E240EE","MODEL_NO":"PC","ISP_NAME":"000000000","OS_TYPE":"X","OS_VERSION":"00000000000000000000","UUID":"000000000000000000000000","BODY_TYPE":1,"STATUS_CODE":0,"HEADER_LENGTH":2,"BODY_LENGTH":0}}] for session 2ha4bq5o; nested exception is org.springframework.web.socket.sockjs.SockJsMessageDeliveryException: Failed to deliver message(s) [{"body":{"pushItemResultList":[{"deviceMessageUuid":"TMT124e22c360b5423e86cfefedd5b488f7171080392139804410","type":"PPC","status":0}]},"header":{"status":0},"platform-header":{"VERSION":"PHV102","APPLICATION_ID":"PFAP","MESSAGE_ID":"M00000002","SESSION_ID":0,"TRANSACTION_ID":1553440026465,"SERVICE_ID":0,"IMEI":"00000000000000000000","WIFI_MAC":"309C23E240EE","MSISDN":"309C23E240EE","MODEL_NO":"PC","ISP_NAME":"000000000","OS_TYPE":"X","OS_VERSION":"00000000000000000000","UUID":"000000000000000000000000","BODY_TYPE":1,"STATUS_CODE":0,"HEADER_LENGTH":2,"BODY_LENGTH":0}}] for session 2ha4bq5o: Session closed
        at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.delegateMessages(AbstractSockJsSession.java:385)
        at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.handleMessage(WebSocketServerSockJsSession.java:194)
        at org.springframework.web.socket.sockjs.transport.handler.SockJsWebSocketHandler.handleTextMessage(SockJsWebSocketHandler.java:92)
        at org.springframework.web.socket.handler.AbstractWebSocketHandler.handleMessage(AbstractWebSocketHandler.java:43)
        at org.springframework.web.socket.adapter.standard.StandardWebSocketHandlerAdapter.handleTextMessage(StandardWebSocketHandlerAdapter.java:110)
        at org.springframework.web.socket.adapter.standard.StandardWebSocketHandlerAdapter.access$000(StandardWebSocketHandlerAdapter.java:42)
        at org.springframework.web.socket.adapter.standard.StandardWebSocketHandlerAdapter$3.onMessage(StandardWebSocketHandlerAdapter.java:81)
        at org.springframework.web.socket.adapter.standard.StandardWebSocketHandlerAdapter$3.onMessage(StandardWebSocketHandlerAdapter.java:78)
        at org.apache.tomcat.websocket.WsFrameBase.sendMessageText(WsFrameBase.java:394)
        at org.apache.tomcat.websocket.server.WsFrameServer.sendMessageText(WsFrameServer.java:119)
        at org.apache.tomcat.websocket.WsFrameBase.processDataText(WsFrameBase.java:495)
        at org.apache.tomcat.websocket.WsFrameBase.processData(WsFrameBase.java:294)
        at org.apache.tomcat.websocket.WsFrameBase.processInputBuffer(WsFrameBase.java:133)
        at org.apache.tomcat.websocket.server.WsFrameServer.onDataAvailable(WsFrameServer.java:82)
        at org.apache.tomcat.websocket.server.WsFrameServer.doOnDataAvailable(WsFrameServer.java:171)
        at org.apache.tomcat.websocket.server.WsFrameServer.notifyDataAvailable(WsFrameServer.java:151)
        at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.upgradeDispatch(WsHttpUpgradeHandler.java:148)
        at org.apache.coyote.http11.upgrade.UpgradeProcessorInternal.dispatch(UpgradeProcessorInternal.java:54)
        at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
        at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:806)
        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1498)
        at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
Caused by: org.springframework.web.socket.sockjs.SockJsMessageDeliveryException: Failed to deliver message(s) [{"body":{"pushItemResultList":[{"deviceMessageUuid":"TMT124e22c360b5423e86cfefedd5b488f7171080392139804410","type":"PPC","status":0}]},"header":{"status":0},"platform-header":{"VERSION":"PHV102","APPLICATION_ID":"PFAP","MESSAGE_ID":"M00000002","SESSION_ID":0,"TRANSACTION_ID":1553440026465,"SERVICE_ID":0,"IMEI":"00000000000000000000","WIFI_MAC":"309C23E240EE","MSISDN":"309C23E240EE","MODEL_NO":"PC","ISP_NAME":"000000000","OS_TYPE":"X","OS_VERSION":"00000000000000000000","UUID":"000000000000000000000000","BODY_TYPE":1,"STATUS_CODE":0,"HEADER_LENGTH":2,"BODY_LENGTH":0}}] for session 2ha4bq5o: Session closed
        at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.delegateMessages(AbstractSockJsSession.java:377)
        ... 25 common frames omitted
java.lang.IllegalStateException: Cannot send a message when session is closed
        at org.springframework.util.Assert.state(Assert.java:70)
        at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:160)
        at com.happyhouse.servers.ps.service.PushService$PrivatePushService.push(PushService.java:264)
        at com.happyhouse.servers.ps.service.PushService.pushItem(PushService.java:66)
        at com.happyhouse.servers.ps.service.PrivatePushService.push(PrivatePushService.java:105)
        at com.happyhouse.servers.ps.service.PushItemServiceHandler.handler(PushItemServiceHandler.java:166)
        at com.happyhouse.servers.ps.service.MessageDirector.handleByPushType(MessageDirector.java:214)
        at com.happyhouse.servers.ps.service.MessageDirector.director(MessageDirector.java:186)
        at com.happyhouse.servers.ps.repository.queue.listener.RestfulPushItemListBackgroundQueueItemListener.handler(RestfulPushItemListBackgroundQueueItemListener.java:85)
        at com.happyhouse.servers.ps.repository.queue.listener.RestfulPushItemListBackgroundQueueItemListener.run(RestfulPushItemListBackgroundQueueItemListener.java:54)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.Thread.run(Thread.java:745)
[2019-07-04 16:19:54][DEBUG][o.s.b.w.f.OrderedRequestContextFilter] - Bound request context to thread: org.apache.catalina.connector.RequestFacade@69c34395
[2019-07-04 16:19:54][DEBUG][o.s.b.w.f.OrderedRequestContextFilter] - Cleared thread-bound request context: org.apache.catalina.connector.RequestFacade@69c34395
java.lang.IllegalStateException: Cannot send a message when session is closed
        at org.springframework.util.Assert.state(Assert.java:70)
        at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:160)
        at com.happyhouse.servers.ps.service.PushService$PrivatePushService.push(PushService.java:264)
        at com.happyhouse.servers.ps.service.PushService.pushItem(PushService.java:66)
        at com.happyhouse.servers.ps.service.PrivatePushService.push(PrivatePushService.java:105)
        at com.happyhouse.servers.ps.service.PushItemServiceHandler.handler(PushItemServiceHandler.java:166)
        at com.happyhouse.servers.ps.service.MessageDirector.handleByPushType(MessageDirector.java:214)
        at com.happyhouse.servers.ps.service.MessageDirector.director(MessageDirector.java:186)
        at com.happyhouse.servers.ps.repository.queue.listener.RestfulPushItemListBackgroundQueueItemListener.handler(RestfulPushItemListBackgroundQueueItemListener.java:85)
        at com.happyhouse.servers.ps.repository.queue.listener.RestfulPushItemListBackgroundQueueItemListener.run(RestfulPushItemListBackgroundQueueItemListener.java:54)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.Thread.run(Thread.java:745)
java.lang.IllegalStateException: Cannot send a message when session is closed
        at org.springframework.util.Assert.state(Assert.java:70)
        at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:160)
        at com.happyhouse.servers.ps.service.PushService$PrivatePushService.push(PushService.java:264)
        at com.happyhouse.servers.ps.service.PushService.pushItem(PushService.java:66)
        at com.happyhouse.servers.ps.service.PrivatePushService.push(PrivatePushService.java:105)
        at com.happyhouse.servers.ps.service.PushItemServiceHandler.handler(PushItemServiceHandler.java:166)
        at com.happyhouse.servers.ps.service.MessageDirector.handleByPushType(MessageDirector.java:214)
        at com.happyhouse.servers.ps.service.MessageDirector.director(MessageDirector.java:186)
        at com.happyhouse.servers.ps.repository.queue.listener.RestfulPushItemListBackgroundQueueItemListener.handler(RestfulPushItemListBackgroundQueueItemListener.java:85)
        at com.happyhouse.servers.ps.repository.queue.listener.RestfulPushItemListBackgroundQueueItemListener.run(RestfulPushItemListBackgroundQueueItemListener.java:54)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.Thread.run(Thread.java:745)
[2019-07-04 16:19:55][DEBUG][o.s.b.w.f.OrderedRequestContextFilter] - Bound request context to thread: org.apache.catalina.connector.RequestFacade@69c34395
[2019-07-04 16:19:55][DEBUG][o.s.b.w.f.OrderedRequestContextFilter] - Cleared thread-bound request context: org.apache.catalina.connector.RequestFacade@69c34395
java.lang.IllegalStateException: Cannot send a message when session is closed
        at org.springframework.util.Assert.state(Assert.java:70)
        at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:160)
        at com.happyhouse.servers.ps.service.PushService$PrivatePushService.push(PushService.java:264)
        at com.happyhouse.servers.ps.service.PushService.pushItem(PushService.java:66)
        at com.happyhouse.servers.ps.service.PrivatePushService.push(PrivatePushService.java:105)
        at com.happyhouse.servers.ps.service.PushItemServiceHandler.handler(PushItemServiceHandler.java:166)
        at com.happyhouse.servers.ps.service.MessageDirector.handleByPushType(MessageDirector.java:214)
        at com.happyhouse.servers.ps.service.MessageDirector.director(MessageDirector.java:186)
        at com.happyhouse.servers.ps.repository.queue.listener.RestfulPushItemListBackgroundQueueItemListener.handler(RestfulPushItemListBackgroundQueueItemListener.java:85)
        at com.happyhouse.servers.ps.repository.queue.listener.RestfulPushItemListBackgroundQueueItemListener.run(RestfulPushItemListBackgroundQueueItemListener.java:54)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.Thread.run(Thread.java:745)
java.lang.IllegalStateException: Cannot send a message when session is closed
        at org.springframework.util.Assert.state(Assert.java:70)
        at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:160)
        at com.happyhouse.servers.ps.service.PushService$PrivatePushService.push(PushService.java:264)
        at com.happyhouse.servers.ps.service.PushService.pushItem(PushService.java:66)
        at com.happyhouse.servers.ps.service.PrivatePushService.push(PrivatePushService.java:105)
        at com.happyhouse.servers.ps.service.PushItemServiceHandler.handler(PushItemServiceHandler.java:166)
        at com.happyhouse.servers.ps.service.MessageDirector.handleByPushType(MessageDirector.java:214)
        at com.happyhouse.servers.ps.service.MessageDirector.director(MessageDirector.java:186)
        at com.happyhouse.servers.ps.repository.queue.listener.RestfulPushItemListBackgroundQueueItemListener.handler(RestfulPushItemListBackgroundQueueItemListener.java:85)
        at com.happyhouse.servers.ps.repository.queue.listener.RestfulPushItemListBackgroundQueueItemListener.run(RestfulPushItemListBackgroundQueueItemListener.java:54)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.Thread.run(Thread.java:745)
[2019-07-04 16:19:56][DEBUG][o.s.b.w.f.OrderedRequestContextFilter] - Bound request context to thread: org.apache.catalina.connector.RequestFacade@69c34395
[2019-07-04 16:19:56][DEBUG][o.s.b.w.f.OrderedRequestContextFilter] - Cleared thread-bound request context: org.apache.catalina.connector.RequestFacade@69c34395
java.lang.IllegalStateException: Cannot send a message when session is closed
        at org.springframework.util.Assert.state(Assert.java:70)
        at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:160)
        at com.happyhouse.servers.ps.service.PushService$PrivatePushService.push(PushService.java:264)
        at com.happyhouse.servers.ps.service.PushService.pushItem(PushService.java:66)
        at com.happyhouse.servers.ps.service.PrivatePushService.push(PrivatePushService.java:105)
        at com.happyhouse.servers.ps.service.PushItemServiceHandler.handler(PushItemServiceHandler.java:166)
        at com.happyhouse.servers.ps.service.MessageDirector.handleByPushType(MessageDirector.java:214)
        at com.happyhouse.servers.ps.service.MessageDirector.director(MessageDirector.java:186)
        at com.happyhouse.servers.ps.repository.queue.listener.RestfulPushItemListBackgroundQueueItemListener.handler(RestfulPushItemListBackgroundQueueItemListener.java:85)
        at com.happyhouse.servers.ps.repository.queue.listener.RestfulPushItemListBackgroundQueueItemListener.run(RestfulPushItemListBackgroundQueueItemListener.java:54)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.Thread.run(Thread.java:745)
java.lang.IllegalStateException: Cannot send a message when session is closed
        at org.springframework.util.Assert.state(Assert.java:70)
        at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:160)
        at com.happyhouse.servers.ps.service.PushService$PrivatePushService.push(PushService.java:264)
        at com.happyhouse.servers.ps.service.PushService.pushItem(PushService.java:66)
        at com.happyhouse.servers.ps.service.PrivatePushService.push(PrivatePushService.java:105)
        at com.happyhouse.servers.ps.service.PushItemServiceHandler.handler(PushItemServiceHandler.java:166)
        at com.happyhouse.servers.ps.service.MessageDirector.handleByPushType(MessageDirector.java:214)
        at com.happyhouse.servers.ps.service.MessageDirector.director(MessageDirector.java:186)
        at com.happyhouse.servers.ps.repository.queue.listener.RestfulPushItemListBackgroundQueueItemListener.handler(RestfulPushItemListBackgroundQueueItemListener.java:85)
        at com.happyhouse.servers.ps.repository.queue.listener.RestfulPushItemListBackgroundQueueItemListener.run(RestfulPushItemListBackgroundQueueItemListener.java:54)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.Thread.run(Thread.java:745)
[2019-07-04 16:19:57][DEBUG][o.s.b.w.f.OrderedRequestContextFilter] - Bound request context to thread: org.apache.catalina.connector.RequestFacade@69c34395
[2019-07-04 16:19:57][DEBUG][o.s.b.w.f.OrderedRequestContextFilter] - Cleared thread-bound request context: org.apache.catalina.connector.RequestFacade@69c34395
java.lang.IllegalStateException: Cannot send a message when session is closed
        at org.springframework.util.Assert.state(Assert.java:70)
        at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.sendMessage(AbstractSockJsSession.java:160)
        at com.happyhouse.servers.ps.service.PushService$PrivatePushService.push(PushService.java:264)
        at com.happyhouse.servers.ps.service.PushService.pushItem(PushService.java:66)
        at com.happyhouse.servers.ps.service.PrivatePushService.push(PrivatePushService.java:105)
        at com.happyhouse.servers.ps.service.PushItemServiceHandler.handler(PushItemServiceHandler.java:166)
        at com.happyhouse.servers.ps.service.MessageDirector.handleByPushType(MessageDirector.java:214)
        at com.happyhouse.servers.ps.service.MessageDirector.director(MessageDirector.java:186)
        at com.happyhouse.servers.ps.repository.queue.listener.RestfulPushItemListBackgroundQueueItemListener.handler(RestfulPushItemListBackgroundQueueItemListener.java:85)
        at com.happyhouse.servers.ps.repository.queue.listener.RestfulPushItemListBackgroundQueueItemListener.run(RestfulPushItemListBackgroundQueueItemListener.java:54)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at java.lang.Thread.run(Thread.java:745)
[2019-07-04 16:20:23][ERROR][o.s.w.s.h.ExceptionWebSocketHandlerDecorator] - Closing session due to exception for WebSocketServerSockJsSession[id=yxdwhtvu]
java.lang.RuntimeException: org.springframework.web.socket.sockjs.SockJsTransportFailureException: Failed to write SockJsFrame content='a["{\"platform-header\":{\"VERSION\":\"PHV102\",\"APPLICATION_ID\":\"PPSE\",\"ME...(truncated)'; nested exception is java.lang.IllegalStateException: The remote endpoint was in state [TEXT_PARTIAL_WRITING] which is an invalid state for called method
        at com.happyhouse.servers.ps.service.websocket.WebSocketTasHandler.handleTextMessage(WebSocketTasHandler.java:52)
        at org.springframework.web.socket.handler.AbstractWebSocketHandler.handleMessage(AbstractWebSocketHandler.java:43)
        at org.springframework.web.socket.handler.WebSocketHandlerDecorator.handleMessage(WebSocketHandlerDecorator.java:75)
        at org.springframework.web.socket.handler.LoggingWebSocketHandlerDecorator.handleMessage(LoggingWebSocketHandlerDecorator.java:56)
        at org.springframework.web.socket.handler.ExceptionWebSocketHandlerDecorator.handleMessage(ExceptionWebSocketHandlerDecorator.java:58)
        at org.springframework.web.socket.sockjs.transport.session.AbstractSockJsSession.delegateMessages(AbstractSockJsSession.java:380)
        at org.springframework.web.socket.sockjs.transport.session.WebSocketServerSockJsSession.handleMessage(WebSocketServerSockJsSession.java:194)
        at org.springframework.web.socket.sockjs.transport.handler.SockJsWebSocketHandler.handleTextMessage(SockJsWebSocketHandler.java:92)
        at org.springframework.web.socket.handler.AbstractWebSocketHandler.handleMessage(AbstractWebSocketHandler.java:43)
        at org.springframework.web.socket.adapter.standard.StandardWebSocketHandlerAdapter.handleTextMessage(StandardWebSocketHandlerAdapter.java:110)
        at org.springframework.web.socket.adapter.standard.StandardWebSocketHandlerAdapter.access$000(StandardWebSocketHandlerAdapter.java:42)
        at org.springframework.web.socket.adapter.standard.StandardWebSocketHandlerAdapter$3.onMessage(StandardWebSocketHandlerAdapter.java:81)
        at org.springframework.web.socket.adapter.standard.StandardWebSocketHandlerAdapter$3.onMessage(StandardWebSocketHandlerAdapter.java:78)
        at org.apache.tomcat.websocket.WsFrameBase.sendMessageText(WsFrameBase.java:394)
        at org.apache.tomcat.websocket.server.WsFrameServer.sendMessageText(WsFrameServer.java:119)
        at org.apache.tomcat.websocket.WsFrameBase.processDataText(WsFrameBase.java:495)
        at org.apache.tomcat.websocket.WsFrameBase.processData(WsFrameBase.java:294)
        at org.apache.tomcat.websocket.WsFrameBase.processInputBuffer(WsFrameBase.java:133)
        at org.apache.tomcat.websocket.server.WsFrameServer.onDataAvailable(WsFrameServer.java:82)
        at org.apache.tomcat.websocket.server.WsFrameServer.doOnDataAvailable(WsFrameServer.java:171)
        at org.apache.tomcat.websocket.server.WsFrameServer.notifyDataAvailable(WsFrameServer.java:151)
        at org.apache.tomcat.websocket.server.WsHttpUpgradeHandler.upgradeDispatch(WsHttpUpgradeHandler.java:148)
        at org.apache.coyote.http11.upgrade.UpgradeProcessorInternal.dispatch(UpgradeProcessorInternal.java:54)
        at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:53)
        at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:806)
        at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1498)
        at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
        at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
        at java.lang.Thread.run(Thread.java:745)
Caused by: org.springframework.web.socket.sockjs.SockJsTransportFailureException: Failed to write SockJsFrame content='a["{\"platform-header\":{\"VERSION\":\"PHV102\",\"APPLICATION_ID\":\"PPSE\",\"ME...(truncated)'; nested exception is java.lang.IllegalStateException: The remote endpoint was in state [TEXT_PARTIAL_WRITING] which is an invalid state for called method
        
        


        
