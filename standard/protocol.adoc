= SMS/MMS 대화방 Protocol
by Shin Kwan Young;

== 전문 (PC/Android -> Server)

PC -> Server 또는 Android -> Server 요청시에는 아래, SMSMMS000 전문 1개만을 사용.+
payload 필드에 셋팅할 값은 아래 기술함

[source, xml]
----
<body name="SMSMMS000">
  <request>
    <field name="payload" type="string"/>
  </request>
</body>
----

== SMS 전송 요청 (PC -> Server)
[source, json]
----
{
  "server": {
    "type": "OUT_SMS",
    "receivers": [
      {
        "mobile": "010-1111-2222"
      },
      {
        "mobile": "010-3333-4444"
      }
    ]
  },
  "client": {
    "temp-id": "xxxxxx",
    "text": "SMS 문자 내용"
  }
}
----

== SMS 전송 요청 Push Payload (Server -> Android)
[source, json]
----
{
  "type": "OUT_SMS",
  "receivers": [
    {
      "mobile": "010-1111-2222"
    },
    {
      "mobile": "010-3333-4444"
    }
  ],
  "temp-id": "xxxxxx",
  "text": "SMS 문자 내용"
}
----

== MMS 전송 요청 (PC -> Server)
[source, json]
----
{
  "server": {
    "type": "OUT_MMS",
    "receivers": [
      {
        "mobile": "010-1111-2222"
      },
      {
        "mobile": "010-3333-4444"
      }
    ],
    "body-parts": [
      {
        "part-id": 1,
        "mime-type": "xxxx/yyyy",
        "text": "MMS 문자 내용",
        "file-id": 1
      },
      {
        "part-id": 2,
        "mime-type": "xxxx/yyyy",
        "text": "MMS 문자 내용",
        "file-id": 2
      }
    ]
  },
  "client": {
    "temp-id": "xxxxxx",
    "subject": "MMS 제목"
  }
}
----

== MMS 전송 요청 Push Payload (Server -> Android)
[source, json]
----
{
  "type": "OUT_MMS",
  "receivers": [
    {
      "mobile": "010-1111-2222"
    },
    {
      "mobile": "010-3333-4444"
    }
  ],
  "temp-id": "xxxxxx",
  "subject": "MMS 제목",
  "body-parts": [
    {
      "part-id": 1,
      "mime-type": "xxxx/yyyy",
      "text": "MMS 문자 내용",
      "file-url": "http://x.y.z/a/b/c"
    },
    {
      "part-id": 2,
      "mime-type": "xxxx/yyyy",
      "text": "MMS 문자 내용",
      "file-url": "http://x.y.z/a/b/c"
    }
  ]
}
----

== SMS/MMS 전송 결과 (Android -> Server)
[source, json]
----
{
  "server": {
    "type": "OUT_SMS_MMS_RESULT",
    "receivers": [
      {
        "mobile": "010-1111-2222",
        "name": "홍길동1"
      },
      {
        "mobile": "010-1111-2223",
        "name": "홍길동2"
      },
      {
        "mobile": "010-1111-2224",
        "name": ""
      }
    ]
  },
  "client": {
    "sub-type": "SMS/MMS",
    "temp-id": "xxxxxx",
    "sms": [
      {
        "receiver": "010-1111-2222",
        "result": true,
        "room-id": 222,
        "message-id": 11,
        "unread-count": 1
      },
      {
        "receiver": "010-1111-2222",
        "result": false,
        "room-id": 223,
        "message-id": 22,
        "unread-count": 1
      }
    ],
    "mms": {
      "result": true,
      "room-id": 222,
      "message-id": 11,
      "unread-count": 11
    }
  }
}
----

== SMS/MMS 전송 결과 Push Payload (Server -> PC)
[source, json]
----
{
  "type": "OUT_SMS_MMS_RESULT",
  "sub-type": "SMS/MMS",
  "sms": [
    {
      "result": true,
      "receiver": {
        "name": "이름 또는 전화번호",
        "position": "과장",
        "dept-name": "개발1팀",
        "upper-dept-name": "개발실"
      },
      "room-id": 222,
      "message-id": 11,
      "unread-count": 11
    },
    {
      "receiver": {
        "name": "이름 또는 전화번호",
        "position": "과장",
        "dept-name": "개발1팀",
        "upper-dept-name": "개발실"
      },
      "result": false,
      "room-id": 222,
      "message-id": 11,
      "unread-count": 11
    }
  ],
  "mms": {
    "result": true,
    "receivers": [
      {
        "name": "이름 또는 전화번호",
        "position": "과장",
        "dept-name": "개발1팀",
        "upper-dept-name": "개발실"
      },
      {
        "name": "이름 또는 전화번호",
        "position": "과장",
        "dept-name": "개발1팀",
        "upper-dept-name": "개발실"
      }
    ],
    "room-id": 222,
    "message-id": 11,
    "unread-count": 11
  }
}
----

== SMS 수신 요청 (Android -> Server)
[source, json]
----
{
  "server": {
    "type": "IN_SMS",
    "sender": {
      "mobile": "010-1111-2222",
      "name": "홍길동"
    }
  },
  "client": {
    "room-id": 222,
    "room-unread-count": 11,
    "message-id": 11,
    "text": "SMS 문자 내용"
  }
}
----

== SMS 수신 Push Payload (Server -> PC)
[source, json]
----
{
  "type": "IN_SMS",
  "sender": {
    "name": "홍길동",
    "position": "과장",
    "dept-name": "개발1팀",
    "upper-dept-name": "개발실"
  },
  "room-id": 222,
  "room-unread-count": 11,
  "message-id": 11,
  "text": "SMS 문자 내용"
}
----

== MMS 수신 요청 (Android -> Server)
[source, json]
----
{
  "server": {
    "type": "IN_MMS",
    "sender": {
      "mobile": "010-1111-2222",
      "name": "홍길동"
    },
    "body-parts": [
      {
        "part-id": 1,
        "mime-type": "xxxx/yyyy",
        "text": "MMS 문자 내용",
        "file-id": 1
      },
      {
        "part-id": 2,
        "mime-type": "xxxx/yyyy",
        "text": "MMS 문자 내용",
        "file-id": 2
      }
    ]
  },
  "client": {
    "room-id": 222,
    "room-unread-count": 11,
    "message-id": 11,
    "subject": "MMS 제목"
  }
}
----

== MMS 수신 Push Payload (Server -> PC)
[source, json]
----
{
  "type": "IN_MMS",
  "sender": {
    "name": "홍길동",
    "position": "과장",
    "dept-name": "개발1팀",
    "upper-dept-name": "개발실"
  },
  "body-parts": [
    {
      "part-id": 1,
      "mime-type": "xxxx/yyyy",
      "text": "MMS 문자 내용",
      "file-url": "http://x.y.z/a/b/c"
    },
    {
      "part-id": 2,
      "mime-type": "xxxx/yyyy",
      "text": "MMS 문자 내용",
      "file-url": "http://x.y.z/a/b/c"
    }
  ],
  "room-id": 222,
  "room-unread-count": 11,
  "message-id": 11,
  "subject": "MMS 제목"
}
----

== SMS/MMS 싱크 요청 (Android -> Server)
[source, json]
----
{
{
  "server": {
    "type": "SYNC_SMS_MMS"
  },
  "client": {
    "sub-type": "READ/ROOM_DEL/MESSAGE_DEL",
    "room-id": 222,
    "room-unread-count": 11,
    "message-id": 11
  }
}
----

== SMS/MMS 싱크 요청 Push Payload (Server -> PC)
[source, json]
----
{
  "type": "SYNC_SMS_MMS",
  "sub-type": "READ/ROOM_DEL/MESSAGE_DEL",
  "room-id": 222,
  "room-unread-count": 11,
  "message-id": 11
}
----

== SMS/MMS 대화방 동기화 ON/OFF 요청 (Android -> Server)
[source, json]
----
{
  "server": {
    "type": "ON_OFF_SMS_MMS",
    "on-off": true
  }
}
----

== SMS/MMS 대화방 동기화 ON/OFF 응답 (Server <- Android)

SMS/MMS 대화방 동기화 ON/OFF 요청에 대한 응답결과는
header 의 status 에 설정

== SMS/MMS 대화방 동기화 ON/OFF Push Payload (Server -> PC)

[source, json]
----
{
  "type": "ON_OFF_SMS_MMS",
  "on-off": true
}
----
